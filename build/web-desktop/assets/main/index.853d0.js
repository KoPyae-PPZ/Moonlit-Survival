window.__require=function e(t,i,n){function o(a,c){if(!i[a]){if(!t[a]){var r=a.split("/");if(r=r[r.length-1],!t[r]){var h="function"==typeof __require&&__require;if(!c&&h)return h(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+a+"'")}a=r}var l=i[a]={exports:{}};t[a][0].call(l.exports,function(e){return o(t[a][1][e]||e)},l,l.exports,e,t,i,n)}return i[a].exports}for(var s="function"==typeof __require&&__require,a=0;a<n.length;a++)o(n[a]);return o}({BotCharacterController:[function(e,t){"use strict";cc._RF.push(t,"d79d3JwntlPl7/KxYldGevM","BotCharacterController"),cc.Class({extends:cc.Component,properties:{cID:0,moveSpeed:0,startPos:new cc.Vec2,targetPos:new cc.Vec2,normalCharMove:null,charImages:{default:[],type:cc.SpriteFrame},femaleAudio:{default:null,type:cc.AudioSource},maleAudio:{default:null,type:cc.AudioSource},werewolfAudio:{default:null,type:cc.AudioSource}},onLoad:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.Anim=this.node.getComponent(cc.Animation),this.runningBack=!1,this.isAttacked=!1,this.isDestroyed=!1,this.rdnImg=0,this.init(),this.setupCharacter(),this.move()},linkwithMainLayer:function(e){this.mainController=e},onEnable:function(){cc.director.getCollisionManager().enabled=!0},onDisable:function(){cc.director.getCollisionManager().enabled=!1},init:function(){this.startPos=cc.v2(this.randomIntFromInterval(750,800),this.randomIntFromInterval(-200,200)),this.node.setPosition(this.startPos),this.moveSpeed=this.randomIntFromInterval(10,15),this.targetPos.y=this.randomIntFromInterval(-220,220)},setupCharacter:function(){var e=this.randomIntFromInterval(0,2);switch(this.cID=e,0==this.cID?this.node.group="human":1==this.cID?this.node.group="runBack":this.node.group="werewolf",this.rdnImg=this.randomIntFromInterval(0,1),this.rdnImg){case 0:this.Anim.play("manWalkAnim");break;case 1:this.Anim.play("girlWalkAnim")}this.originImg=this.charImages[this.rdnImg],this.node.getComponent(cc.Sprite).spriteFrame=this.originImg},onKeyDown:function(e){if(!this.isAttacked)switch(e.keyCode){case cc.macro.KEY.k:this.isAttacked=!0,this.scheduleOnce(this.stopAttack,.4)}},onKeyUp:function(){},stopAttack:function(){this.isAttacked=!1},onCollisionExit:function(e,t){"moonLight"===e.node.group&&"werewolf"===t.node.group&&this.showBackOrigin()},onCollisionEnter:function(e,t){"moonLight"===e.node.group&&"werewolf"===t.node.group?this.showTrueSelf():"ship"===e.node.group&&"runBack"===t.node.group?(this.normalCharMove.stop(),this.runningBack=!0,this.node.scaleX=-.1):"ship"===e.node.group&&"human"===t.node.group?this.moveToShip():"ship"===e.node.group&&"werewolf"===t.node.group&&this.moveToShip()},onCollisionStay:function(e,t){this.isDestroyed||"spear"===e.node.group&&this.isAttacked&&(this.isDestroyed=!0,"human"!=t.node.group&&"runBack"!=t.node.group||(0==this.rdnImg?(this.Anim.play("manAttackedAnim"),this.maleAudio.play()):1==this.rdnImg&&(this.Anim.play("girlAttackedAnim"),this.femaleAudio.play()),this.mainController.killedHuman()),"werewolf"==t.node.group&&this.werewolfAudio.play(),this.scheduleOnce(this.nodeDestroyed,.4))},nodeDestroyed:function(){this.node.opacity=0,this.normalCharMove.stop()},rescuedHuman:function(){this.node.opacity=0,this.mainController.rescuedHuman()},attackedShip:function(){this.node.opacity=0,this.mainController.werewolfAttackShip()},showBackOrigin:function(){switch(this.rdnImg){case 0:this.Anim.play("manWalkAnim");break;case 1:this.Anim.play("girlWalkAnim")}},showTrueSelf:function(){this.Anim.play("wereWolfAnim")},restartCharater:function(){switch(self.rdnImg){case 0:self.Anim.play("manWalkAnim");break;case 1:self.Anim.play("girlWalkAnim")}},move:function(){this.normalCharMove=cc.tween(this.node).to(this.moveSpeed,{position:this.targetPos}),this.normalCharMove.start(),console.log(this.normalCharMove)},moveToShip:function(){this.moveToShip=cc.tween(this.node).to(2,{position:cc.v2(-250,0)}),this.moveToShip.start(),"human"==this.node.group?this.scheduleOnce(this.rescuedHuman,2):this.scheduleOnce(this.attackedShip,2)},testClick:function(){this.slowMove()},randomIntFromInterval:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},update:function(e){this.runningBack&&(this.node.x+=200*e)}}),cc._RF.pop()},{}],GameMainController:[function(e,t){"use strict";cc._RF.push(t,"39a34XcyyBB16bM8c67kbLh","GameMainController"),cc.Class({extends:cc.Component,properties:{botCharacterPrefab:cc.Prefab,botCharacterLayout:cc.Node,maxCount:0,spawnInterval:0,currentCount:0},onLoad:function(){this.spwanCharacter()},spwanCharacter:function(){var e=this,t=cc.instantiate(e.botCharacterPrefab);e.botCharacterLayout.addChild(t),e.currentCount++,e.currentCount<e.maxCount&&e.scheduleOnce(function(){e.spwanCharacter()},e.spawnInterval)}}),cc._RF.pop()},{}],MainMenuController:[function(e,t){"use strict";cc._RF.push(t,"851d9m2euVNab07k7z2UbGi","MainMenuController"),cc.Class({extends:cc.Component,properties:{pop:cc.Node,mask:cc.Node,text:cc.Label},onLoad:function(){this.hidePop()},showPop:function(){this.mask.active=!0,this.pop.active=!0},hidePop:function(){this.mask.active=!1,this.pop.active=!1},onClickStart:function(){var e=this;e.showPop(),e.scheduleOnce(function(){e.text.string="Error Detected! \n Click Quit for more informations!"},2.5),e.scheduleOnce(function(){e.hidePop()},5)},onCLickQuit:function(){console.log("Go to Game"),cc.director.loadScene("GameScene")},onCLickCredit:function(){console.log("Go to Game"),cc.director.loadScene("CreditScene")}}),cc._RF.pop()},{}],creditController:[function(e,t){"use strict";cc._RF.push(t,"ee4d7J0rmpGqZKtFUueUv1W","creditController"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){this.hidePop()},onCLickMenu:function(){console.log("Go to Game"),cc.director.loadScene("MainMenuScene")}}),cc._RF.pop()},{}],mainCharacterCtrl:[function(e,t){"use strict";cc._RF.push(t,"8eaa6+++6BKbI80LlsHhsir","mainCharacterCtrl"),cc.Class({extends:cc.Component,properties:{speed:cc.v2(0,0),movingDir:0,maxSpeed:cc.v2(200,200),drag:1e3,spearAudio:{default:null,type:cc.AudioSource}},onLoad:function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onKeyUp,this),this.Anim=this.node.getComponent(cc.Animation),this.prePosition=cc.v2(),this.preStep=cc.v2(),this.onPressDown=!0,this.speed.x=0,this.speed.y=0,this.collisionX=0,this.collisionY=0,this.directionX=0,this.directionY=0,this.isAttacking=!1},onEnable:function(){cc.director.getCollisionManager().enabled=!0},onDisable:function(){cc.director.getCollisionManager().enabled=!1},onCollisionEnter:function(e,t){this.touchingNumber++;var i=e.world.aabb,n=e.world.preAabb.clone(),o=t.world.aabb,s=t.world.preAabb.clone();if(s.x=o.x,n.x=i.x,s.y=o.y,n.y=i.y,cc.Intersection.rectRect(s,n))return"wall"===e.node.group&&(s.xMax>n.xMax?this.collisionX=-1:s.xMin<n.xMin&&(this.collisionX=1),s.yMax<n.yMax?this.collisionY=1:s.yMin>n.yMin&&(this.collisionY=-1)),this.speed.x=0,void(this.speed.y=0)},onCollisionExit:function(){this.collisionX=0,this.collisionY=0,this.node.color=new cc.Color(cc.Color.WHITE)},onKeyDown:function(e){if(!this.isAttacking)switch(e.keyCode){case cc.macro.KEY.a:this.directionX=-1,this.node.scaleX=.1,this.onPressDown&&this.scheduleOnce(this.walk);break;case cc.macro.KEY.d:this.directionX=1,this.node.scaleX=-.1,this.onPressDown&&this.scheduleOnce(this.walk);break;case cc.macro.KEY.w:this.directionY=1,this.onPressDown&&this.scheduleOnce(this.walk);break;case cc.macro.KEY.s:this.directionY=-1,this.onPressDown&&this.scheduleOnce(this.walk);break;case cc.macro.KEY.k:this.Anim.play("attack"),this.spearAudio.play(),this.isAttacking=!0,this.scheduleOnce(this.stayIdle,.4)}this.onPressDown=!1},stayIdle:function(){this.Anim.play("idle"),this.isAttacking=!1},onKeyUp:function(e){switch(this.onPressDown=!0,e.keyCode){case cc.macro.KEY.a:case cc.macro.KEY.d:this.directionX=0,this.stayIdle();break;case cc.macro.KEY.w:case cc.macro.KEY.s:this.directionY=0,this.stayIdle()}},walk:function(){this.Anim.play("walk"),console.log("walk")},start:function(){},update:function(e){0===this.directionY?this.speed.y>0?(this.speed.y-=this.drag*e,this.speed.y<=0&&(this.speed.y=0)):this.speed.y<0&&(this.speed.y+=this.drag*e,this.speed.y>=0&&(this.speed.y=0)):(this.speed.y+=(this.directionY>0?1:-1)*this.drag*e,Math.abs(this.speed.y)>this.maxSpeed.y&&(this.speed.y=this.speed.y>0?this.maxSpeed.y:-this.maxSpeed.y)),0===this.directionX?this.speed.x>0?(this.speed.x-=this.drag*e,this.speed.x<=0&&(this.speed.x=0)):this.speed.x<0&&(this.speed.x+=this.drag*e,this.speed.x>=0&&(this.speed.x=0)):(this.speed.x+=(this.directionX>0?1:-1)*this.drag*e,Math.abs(this.speed.x)>this.maxSpeed.x&&(this.speed.x=this.speed.x>0?this.maxSpeed.x:-this.maxSpeed.x)),(this.speed.x*this.collisionX>0||this.isAttacking)&&(this.speed.x=0),(this.speed.y*this.collisionY>0||this.isAttacking)&&(this.speed.y=0),this.prePosition.x=this.node.x,this.prePosition.y=this.node.y,this.preStep.x=this.speed.x*e,this.preStep.y=this.speed.y*e,this.node.x+=this.speed.x*e,this.node.y+=this.speed.y*e}}),cc._RF.pop()},{}],mainController:[function(e,t){"use strict";cc._RF.push(t,"53519cQg99CJpdwKUJBy7be","mainController"),cc.Class({extends:cc.Component,properties:{speed:cc.v2(0,0),maxSpeed:cc.v2(500,500),movingDir:0,botCharacterPrefab:cc.Prefab,botCharacterLayout:cc.Node,maxCount:0,spawnInterval:0,currentCount:0,waveCount:0,humanKilledCount:0,humanRescuedCount:0,countLabel1:{default:null,type:cc.Label},countLabel2:{default:null,type:cc.Label},moonLight:{default:null,type:cc.Node},gameOverNode:{default:null,type:cc.Node},gameOverLabel1:{default:null,type:cc.Node},gameOverLabel2:{default:null,type:cc.Node},gameOverLabel3:{default:null,type:cc.Node},waveCompletedNode:{default:null,type:cc.Node},waveCountLabel:{default:null,type:cc.Label},finishedGameNode:{default:null,type:cc.Node},finishedGameLabel:{default:null,type:cc.Node},finishedGameLabel1:{default:null,type:cc.Node},finishedGameLabel2:{default:null,type:cc.Node},finishedGameLabel3:{default:null,type:cc.Node},instructionNode:{default:null,type:cc.Node},controlNode:{default:null,type:cc.Node},shipHealthBar:{default:null,type:cc.ProgressBar},werewolfAudio:{default:null,type:cc.AudioSource}},onLoad:function(){this.moonLightMove(),this.waveCount=0,this.seenControl=!1,this.isWaveCompleted=!1,this.showInstruction()},showInstruction:function(){this.instructionNode.active=!0,this.scheduleOnce(this.showControl,10)},showControl:function(){this.instructionNode.active=!1,this.controlNode.active=!0},spwanCharacter:function(){var e=this;if(!this.isWaveCompleted){var t=cc.instantiate(e.botCharacterPrefab);if(t.getComponent("BotCharacterController").linkwithMainLayer(e),e.botCharacterLayout.addChild(t),e.currentCount++,e.spawnInterval=4,!(e.currentCount<e.maxCount))return;e.spawn=e.scheduleOnce(function(){e.spwanCharacter()},e.spawnInterval)}},nextWave:function(){this.isWaveCompleted=!1,this.waveCompletedNode.active=!1,this.spwanCharacter()},killedHuman:function(){this.humanKilledCount+=1,this.countLabel1.string=this.humanKilledCount,20==this.humanKilledCount&&this.finishedGame(3)},rescuedHuman:function(){this.humanRescuedCount+=1,this.countLabel2.string=this.humanRescuedCount,this.humanRescuedCount==10*this.waveCount&&(5==this.waveCount?this.resucedHumanFinishedGame():this.waveCompleted())},werewolfAttackShip:function(){this.werewolfAudio.play(),this.shipHealthBar.progress-=.1,console.log(this.shipHealthBar.progress),this.shipHealthBar.progress<.1&&this.finishedGame(1)},moonLightMove:function(){var e,t,i=this;e=this.randomIntFromInterval(30,310),i.moonLight.y>0?this.randomIntFromInterval(-190,-20):this.randomIntFromInterval(20,190),t=this.randomIntFromInterval(-190,190);var n=cc.tween(i.moonLight).to(1,{position:cc.v2(e,t)});n.start(),i.scheduleOnce(function(){n.stop()},1),i.scheduleOnce(function(){i.moonLightMove()},1)},startGame:function(){this.seenControl||(this.controlNode.active=!1,this.gameOverNode.active=!1,this.humanKilledCount=0,this.humanRescuedCount=0,this.waveCount=0,this.currentCount=0,this.waveCompleted(),this.seenControl=!0)},restartGame:function(){this.gameOverNode.active=!1,this.humanKilledCount=0,this.humanRescuedCount=0,this.waveCount=0,this.currentCount=0,this.shipHealthBar.progress=1,this.countLabel1.string=this.humanKilledCount,this.countLabel2.string=this.humanRescuedCount,this.waveCompleted(),cc.director.loadScene("MainMenuScene")},waveCompleted:function(){this.waveCount+=1,this.currentCount=0,console.log(this.waveCount),this.waveCompletedNode.active=!0,this.waveCountLabel.string=this.waveCount,this.botCharacterLayout.removeAllChildren(),clearTimeout(this.spawnTimeout),this.scheduleOnce(this.nextWave,2)},resucedHumanFinishedGame:function(){this.finishedGameNode.active=!0,this.finishedGameLabel.active=!0,this.finishedGameLabel1.active=!1,this.finishedGameLabel2.active=!1,this.finishedGameLabel3.active=!1,this.botCharacterLayout.removeAllChildren(),this.scheduleOnce(function(){this.finishedGameLabel.active=!1,this.finishedGameLabel1.active=!0,this.scheduleOnce(function(){this.finishedGameLabel1.active=!1,this.finishedGameLabel2.active=!0,this.scheduleOnce(function(){this.finishedGameLabel2.active=!1,this.finishedGameLabel3.active=!0,this.scheduleOnce(function(){this.finishedGame(2)},2)},2)},2)},2)},finishedGame:function(e){this.botCharacterLayout.removeAllChildren(),this.gameOverNode.active=!0,this.gameOverLabel1.active=!1,this.gameOverLabel2.active=!1,this.gameOverLabel3.active=!1,this.finishedGameNode.active=!1,1==e?this.gameOverLabel1.active=!0:2==e?this.gameOverLabel2.active=!0:this.gameOverLabel3.active=!0},randomIntFromInterval:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},start:function(){},update:function(){}}),cc._RF.pop()},{}]},{},["creditController","MainMenuController","BotCharacterController","GameMainController","mainCharacterCtrl","mainController"]);